/*! For license information please see 5445.a75a76b2.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkwallet_sign=self.webpackChunkwallet_sign||[]).push([[5445],{25445:function(r,t,e){e.r(t),e.d(t,{encodeToCurve:function(){return Lt},hashToCurve:function(){return Nt},schnorr:function(){return Zt},secp256k1:function(){return ht}});var n={};e.r(n),e.d(n,{aInRange:function(){return Q},abool:function(){return Z},abytes:function(){return O},bitGet:function(){return tr},bitLen:function(){return rr},bitMask:function(){return nr},bitSet:function(){return er},bytesToHex:function(){return q},bytesToNumberBE:function(){return V},bytesToNumberLE:function(){return _},concatBytes:function(){return W},createHmacDrbg:function(){return ar},ensureBytes:function(){return G},equalBytes:function(){return Y},hexToBytes:function(){return F},hexToNumber:function(){return N},inRange:function(){return J},isBytes:function(){return I},memoized:function(){return cr},notImplemented:function(){return sr},numberToBytesBE:function(){return M},numberToBytesLE:function(){return K},numberToHexUnpadded:function(){return T},numberToVarBytesBE:function(){return j},utf8ToBytes:function(){return $},validateObject:function(){return fr}});var i=e(15671),o=e(43144),a=e(60136),u=e(29388),f=e(93433),s=e(53752),c=e(16493);function d(r,t,e){return r&t^r&e^t&e}var l=function(r){(0,a.Z)(e,r);var t=(0,u.Z)(e);function e(r,n,o,a){var u;return(0,i.Z)(this,e),(u=t.call(this)).blockLen=r,u.outputLen=n,u.padOffset=o,u.isLE=a,u.finished=!1,u.length=0,u.pos=0,u.destroyed=!1,u.buffer=new Uint8Array(r),u.view=(0,c.GL)(u.buffer),u}return(0,o.Z)(e,[{key:"update",value:function(r){(0,s.$h)(this);for(var t=this.view,e=this.buffer,n=this.blockLen,i=(r=(0,c.O0)(r)).length,o=0;o<i;){var a=Math.min(n-this.pos,i-o);if(a!==n)e.set(r.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===n&&(this.process(t,0),this.pos=0);else for(var u=(0,c.GL)(r);n<=i-o;o+=n)this.process(u,o)}return this.length+=r.length,this.roundClean(),this}},{key:"digestInto",value:function(r){(0,s.$h)(this),(0,s.eB)(r,this),this.finished=!0;var t=this.buffer,e=this.view,n=this.blockLen,i=this.isLE,o=this.pos;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>n-o&&(this.process(e,0),o=0);for(var a=o;a<n;a++)t[a]=0;!function(r,t,e,n){if("function"===typeof r.setBigUint64)return r.setBigUint64(t,e,n);var i=BigInt(32),o=BigInt(4294967295),a=Number(e>>i&o),u=Number(e&o),f=n?4:0,s=n?0:4;r.setUint32(t+f,a,n),r.setUint32(t+s,u,n)}(e,n-8,BigInt(8*this.length),i),this.process(e,0);var u=(0,c.GL)(r),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");var d=f/4,l=this.get();if(d>l.length)throw new Error("_sha2: outputLen bigger than state");for(var h=0;h<d;h++)u.setUint32(4*h,l[h],i)}},{key:"digest",value:function(){var r=this.buffer,t=this.outputLen;this.digestInto(r);var e=r.slice(0,t);return this.destroy(),e}},{key:"_cloneInto",value:function(r){var t;r||(r=new this.constructor),(t=r).set.apply(t,(0,f.Z)(this.get()));var e=this.blockLen,n=this.buffer,i=this.length,o=this.finished,a=this.destroyed,u=this.pos;return r.length=i,r.pos=u,r.finished=o,r.destroyed=a,i%e&&r.buffer.set(n),r}}]),e}(c.kb),h=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),v=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),g=new Uint32Array(64),p=function(r){(0,a.Z)(e,r);var t=(0,u.Z)(e);function e(){var r;return(0,i.Z)(this,e),(r=t.call(this,64,32,8,!1)).A=0|v[0],r.B=0|v[1],r.C=0|v[2],r.D=0|v[3],r.E=0|v[4],r.F=0|v[5],r.G=0|v[6],r.H=0|v[7],r}return(0,o.Z)(e,[{key:"get",value:function(){return[this.A,this.B,this.C,this.D,this.E,this.F,this.G,this.H]}},{key:"set",value:function(r,t,e,n,i,o,a,u){this.A=0|r,this.B=0|t,this.C=0|e,this.D=0|n,this.E=0|i,this.F=0|o,this.G=0|a,this.H=0|u}},{key:"process",value:function(r,t){for(var e=0;e<16;e++,t+=4)g[e]=r.getUint32(t,!1);for(var n=16;n<64;n++){var i=g[n-15],o=g[n-2],a=(0,c.np)(i,7)^(0,c.np)(i,18)^i>>>3,u=(0,c.np)(o,17)^(0,c.np)(o,19)^o>>>10;g[n]=u+g[n-7]+a+g[n-16]|0}var f,s=this.A,l=this.B,v=this.C,p=this.D,y=this.E,w=this.F,m=this.G,b=this.H;for(e=0;e<64;e++){var E=b+((0,c.np)(y,6)^(0,c.np)(y,11)^(0,c.np)(y,25))+((f=y)&w^~f&m)+h[e]+g[e]|0,B=((0,c.np)(s,2)^(0,c.np)(s,13)^(0,c.np)(s,22))+d(s,l,v)|0;b=m,m=w,w=y,y=p+E|0,p=v,v=l,l=s,s=E+B|0}s=s+this.A|0,l=l+this.B|0,v=v+this.C|0,p=p+this.D|0,y=y+this.E|0,w=w+this.F|0,m=m+this.G|0,b=b+this.H|0,this.set(s,l,v,p,y,w,m,b)}},{key:"roundClean",value:function(){g.fill(0)}},{key:"destroy",value:function(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}]),e}(l),y=(0,c.hE)((function(){return new p})),w=e(1413),m=function(r){(0,a.Z)(e,r);var t=(0,u.Z)(e);function e(r,n){var o;(0,i.Z)(this,e),(o=t.call(this)).finished=!1,o.destroyed=!1,(0,s.z3)(r);var a=(0,c.O0)(n);if(o.iHash=r.create(),"function"!==typeof o.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");o.blockLen=o.iHash.blockLen,o.outputLen=o.iHash.outputLen;var u=o.blockLen,f=new Uint8Array(u);f.set(a.length>u?r.create().update(a).digest():a);for(var d=0;d<f.length;d++)f[d]^=54;o.iHash.update(f),o.oHash=r.create();for(var l=0;l<f.length;l++)f[l]^=106;return o.oHash.update(f),f.fill(0),o}return(0,o.Z)(e,[{key:"update",value:function(r){return(0,s.$h)(this),this.iHash.update(r),this}},{key:"digestInto",value:function(r){(0,s.$h)(this),(0,s.gk)(r,this.outputLen),this.finished=!0,this.iHash.digestInto(r),this.oHash.update(r),this.oHash.digestInto(r),this.destroy()}},{key:"digest",value:function(){var r=new Uint8Array(this.oHash.outputLen);return this.digestInto(r),r}},{key:"_cloneInto",value:function(r){r||(r=Object.create(Object.getPrototypeOf(this),{}));var t=this.oHash,e=this.iHash,n=this.finished,i=this.destroyed,o=this.blockLen,a=this.outputLen;return r.finished=n,r.destroyed=i,r.blockLen=o,r.outputLen=a,r.oHash=t._cloneInto(r.oHash),r.iHash=e._cloneInto(r.iHash),r}},{key:"destroy",value:function(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}]),e}(c.kb),b=function(r,t,e){return new m(r,t).update(e).digest()};b.create=function(r,t){return new m(r,t)};var E=e(37762),B=e(98737),x=e(29439),A=BigInt(0),S=BigInt(1),k=BigInt(2);function I(r){return r instanceof Uint8Array||ArrayBuffer.isView(r)&&"Uint8Array"===r.constructor.name}function O(r){if(!I(r))throw new Error("Uint8Array expected")}function Z(r,t){if("boolean"!==typeof t)throw new Error(r+" boolean expected, got "+t)}var R=Array.from({length:256},(function(r,t){return t.toString(16).padStart(2,"0")}));function q(r){O(r);for(var t="",e=0;e<r.length;e++)t+=R[r[e]];return t}function T(r){var t=r.toString(16);return 1&t.length?"0"+t:t}function N(r){if("string"!==typeof r)throw new Error("hex string expected, got "+typeof r);return""===r?A:BigInt("0x"+r)}var L=48,C=57,U=65,H=70,P=97,z=102;function D(r){return r>=L&&r<=C?r-L:r>=U&&r<=H?r-(U-10):r>=P&&r<=z?r-(P-10):void 0}function F(r){if("string"!==typeof r)throw new Error("hex string expected, got "+typeof r);var t=r.length,e=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);for(var n=new Uint8Array(e),i=0,o=0;i<e;i++,o+=2){var a=D(r.charCodeAt(o)),u=D(r.charCodeAt(o+1));if(void 0===a||void 0===u){var f=r[o]+r[o+1];throw new Error('hex string expected, got non-hex character "'+f+'" at index '+o)}n[i]=16*a+u}return n}function V(r){return N(q(r))}function _(r){return O(r),N(q(Uint8Array.from(r).reverse()))}function M(r,t){return F(r.toString(16).padStart(2*t,"0"))}function K(r,t){return M(r,t).reverse()}function j(r){return F(T(r))}function G(r,t,e){var n;if("string"===typeof t)try{n=F(t)}catch(o){throw new Error(r+" must be hex string or Uint8Array, cause: "+o)}else{if(!I(t))throw new Error(r+" must be hex string or Uint8Array");n=Uint8Array.from(t)}var i=n.length;if("number"===typeof e&&i!==e)throw new Error(r+" of length "+e+" expected, got "+i);return n}function W(){for(var r=0,t=0;t<arguments.length;t++){var e=t<0||arguments.length<=t?void 0:arguments[t];O(e),r+=e.length}for(var n=new Uint8Array(r),i=0,o=0;i<arguments.length;i++){var a=i<0||arguments.length<=i?void 0:arguments[i];n.set(a,o),o+=a.length}return n}function Y(r,t){if(r.length!==t.length)return!1;for(var e=0,n=0;n<r.length;n++)e|=r[n]^t[n];return 0===e}function $(r){if("string"!==typeof r)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(r))}var X=function(r){return"bigint"===typeof r&&A<=r};function J(r,t,e){return X(r)&&X(t)&&X(e)&&t<=r&&r<e}function Q(r,t,e,n){if(!J(t,e,n))throw new Error("expected valid "+r+": "+e+" <= n < "+n+", got "+t)}function rr(r){var t;for(t=0;r>A;r>>=S,t+=1);return t}function tr(r,t){return r>>BigInt(t)&S}function er(r,t,e){return r|(e?S:A)<<BigInt(t)}var nr=function(r){return(k<<BigInt(r-1))-S},ir=function(r){return new Uint8Array(r)},or=function(r){return Uint8Array.from(r)};function ar(r,t,e){if("number"!==typeof r||r<2)throw new Error("hashLen must be a number");if("number"!==typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!==typeof e)throw new Error("hmacFn must be a function");var n=ir(r),i=ir(r),o=0,a=function(){n.fill(1),i.fill(0),o=0},u=function(){for(var r=arguments.length,t=new Array(r),o=0;o<r;o++)t[o]=arguments[o];return e.apply(void 0,[i,n].concat(t))},f=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ir();i=u(or([0]),r),n=u(),0!==r.length&&(i=u(or([1]),r),n=u())},s=function(){if(o++>=1e3)throw new Error("drbg: tried 1000 values");for(var r=0,e=[];r<t;){var i=(n=u()).slice();e.push(i),r+=n.length}return W.apply(void 0,e)};return function(r,t){a(),f(r);for(var e=void 0;!(e=t(s()));)f();return a(),e}}var ur={bigint:function(r){return"bigint"===typeof r},function:function(r){return"function"===typeof r},boolean:function(r){return"boolean"===typeof r},string:function(r){return"string"===typeof r},stringOrUint8Array:function(r){return"string"===typeof r||I(r)},isSafeInteger:function(r){return Number.isSafeInteger(r)},array:function(r){return Array.isArray(r)},field:function(r,t){return t.Fp.isValid(r)},hash:function(r){return"function"===typeof r&&Number.isSafeInteger(r.outputLen)}};function fr(r,t){for(var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=function(t,e,n){var i=ur[e];if("function"!==typeof i)throw new Error("invalid validator function");var o=r[t];if((!n||void 0!==o)&&!i(o,r))throw new Error("param "+String(t)+" is invalid. Expected "+e+", got "+o)},i=0,o=Object.entries(t);i<o.length;i++){var a=(0,x.Z)(o[i],2),u=a[0],f=a[1];n(u,f,!1)}for(var s=0,c=Object.entries(e);s<c.length;s++){var d=(0,x.Z)(c[s],2),l=d[0],h=d[1];n(l,h,!0)}return r}var sr=function(){throw new Error("not implemented")};function cr(r){var t=new WeakMap;return function(e){var n=t.get(e);if(void 0!==n)return n;for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];var u=r.apply(void 0,[e].concat(o));return t.set(e,u),u}}var dr=BigInt(0),lr=BigInt(1),hr=BigInt(2),vr=BigInt(3),gr=BigInt(4),pr=BigInt(5),yr=BigInt(8);function wr(r,t){var e=r%t;return e>=dr?e:t+e}function mr(r,t,e){if(t<dr)throw new Error("invalid exponent, negatives unsupported");if(e<=dr)throw new Error("invalid modulus");if(e===lr)return dr;for(var n=lr;t>dr;)t&lr&&(n=n*r%e),r=r*r%e,t>>=lr;return n}function br(r,t,e){for(var n=r;t-- >dr;)n*=n,n%=e;return n}function Er(r,t){if(r===dr)throw new Error("invert: expected non-zero number");if(t<=dr)throw new Error("invert: expected positive modulus, got "+t);for(var e=wr(r,t),n=t,i=dr,o=lr,a=lr,u=dr;e!==dr;){var f=n/e,s=n%e,c=i-a*f,d=o-u*f;n=e,e=s,i=a,o=u,a=c,u=d}if(n!==lr)throw new Error("invert: does not exist");return wr(i,t)}function Br(r){if(r%gr===vr){var t=(r+lr)/gr;return function(r,e){var n=r.pow(e,t);if(!r.eql(r.sqr(n),e))throw new Error("Cannot find square root");return n}}if(r%yr===pr){var e=(r-pr)/yr;return function(r,t){var n=r.mul(t,hr),i=r.pow(n,e),o=r.mul(t,i),a=r.mul(r.mul(o,hr),i),u=r.mul(o,r.sub(a,r.ONE));if(!r.eql(r.sqr(u),t))throw new Error("Cannot find square root");return u}}return function(r){var t,e,n,i=(r-lr)/hr;for(t=r-lr,e=0;t%hr===dr;t/=hr,e++);for(n=hr;n<r&&mr(n,i,r)!==r-lr;n++)if(n>1e3)throw new Error("Cannot find square root: likely non-prime P");if(1===e){var o=(r+lr)/gr;return function(r,t){var e=r.pow(t,o);if(!r.eql(r.sqr(e),t))throw new Error("Cannot find square root");return e}}var a=(t+lr)/hr;return function(r,o){if(r.pow(o,i)===r.neg(r.ONE))throw new Error("Cannot find square root");for(var u=e,f=r.pow(r.mul(r.ONE,n),t),s=r.pow(o,a),c=r.pow(o,t);!r.eql(c,r.ONE);){if(r.eql(c,r.ZERO))return r.ZERO;for(var d=1,l=r.sqr(c);d<u&&!r.eql(l,r.ONE);d++)l=r.sqr(l);var h=r.pow(f,lr<<BigInt(u-d-1));f=r.sqr(h),s=r.mul(s,h),c=r.mul(c,f),u=d}return s}}(r)}var xr=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Ar(r){return fr(r,xr.reduce((function(r,t){return r[t]="function",r}),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"}))}function Sr(r,t,e){if(e<dr)throw new Error("invalid exponent, negatives unsupported");if(e===dr)return r.ONE;if(e===lr)return t;for(var n=r.ONE,i=t;e>dr;)e&lr&&(n=r.mul(n,i)),i=r.sqr(i),e>>=lr;return n}function kr(r,t){var e=new Array(t.length),n=t.reduce((function(t,n,i){return r.is0(n)?t:(e[i]=t,r.mul(t,n))}),r.ONE),i=r.inv(n);return t.reduceRight((function(t,n,i){return r.is0(n)?t:(e[i]=r.mul(t,e[i]),r.mul(t,n))}),i),e}function Ir(r,t){var e=void 0!==t?t:r.toString(2).length;return{nBitLength:e,nByteLength:Math.ceil(e/8)}}function Or(r,t){var e=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(r<=dr)throw new Error("invalid field: expected ORDER > 0, got "+r);var i,o=Ir(r,t),a=o.nBitLength,u=o.nByteLength;if(u>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");var f=Object.freeze({ORDER:r,isLE:e,BITS:a,BYTES:u,MASK:nr(a),ZERO:dr,ONE:lr,create:function(t){return wr(t,r)},isValid:function(t){if("bigint"!==typeof t)throw new Error("invalid field element: expected bigint, got "+typeof t);return dr<=t&&t<r},is0:function(r){return r===dr},isOdd:function(r){return(r&lr)===lr},neg:function(t){return wr(-t,r)},eql:function(r,t){return r===t},sqr:function(t){return wr(t*t,r)},add:function(t,e){return wr(t+e,r)},sub:function(t,e){return wr(t-e,r)},mul:function(t,e){return wr(t*e,r)},pow:function(r,t){return Sr(f,r,t)},div:function(t,e){return wr(t*Er(e,r),r)},sqrN:function(r){return r*r},addN:function(r,t){return r+t},subN:function(r,t){return r-t},mulN:function(r,t){return r*t},inv:function(t){return Er(t,r)},sqrt:n.sqrt||function(t){return i||(i=Br(r)),i(f,t)},invertBatch:function(r){return kr(f,r)},cmov:function(r,t,e){return e?t:r},toBytes:function(r){return e?K(r,u):M(r,u)},fromBytes:function(r){if(r.length!==u)throw new Error("Field.fromBytes: expected "+u+" bytes, got "+r.length);return e?_(r):V(r)}});return Object.freeze(f)}function Zr(r){if("bigint"!==typeof r)throw new Error("field order must be bigint");var t=r.toString(2).length;return Math.ceil(t/8)}function Rr(r){var t=Zr(r);return t+Math.ceil(t/2)}var qr=BigInt(0),Tr=BigInt(1);function Nr(r,t){var e=t.negate();return r?e:t}function Lr(r,t){if(!Number.isSafeInteger(r)||r<=0||r>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+r)}function Cr(r,t){return Lr(r,t),{windows:Math.ceil(t/r)+1,windowSize:Math.pow(2,r-1)}}function Ur(r,t){if(!Array.isArray(r))throw new Error("array expected");r.forEach((function(r,e){if(!(r instanceof t))throw new Error("invalid point at index "+e)}))}function Hr(r,t){if(!Array.isArray(r))throw new Error("array of scalars expected");r.forEach((function(r,e){if(!t.isValid(r))throw new Error("invalid scalar at index "+e)}))}var Pr=new WeakMap,zr=new WeakMap;function Dr(r){return zr.get(r)||1}function Fr(r){return Ar(r.Fp),fr(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze((0,w.Z)((0,w.Z)((0,w.Z)({},Ir(r.n,r.nBitLength)),r),{p:r.Fp.ORDER}))}function Vr(r){void 0!==r.lowS&&Z("lowS",r.lowS),void 0!==r.prehash&&Z("prehash",r.prehash)}var _r=V,Mr=F,Kr=function(r){(0,a.Z)(e,r);var t=(0,u.Z)(e);function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(0,i.Z)(this,e),t.call(this,r)}return(0,o.Z)(e)}((0,B.Z)(Error)),jr={Err:Kr,_tlv:{encode:function(r,t){var e=jr.Err;if(r<0||r>256)throw new e("tlv.encode: wrong tag");if(1&t.length)throw new e("tlv.encode: unpadded data");var n=t.length/2,i=T(n);if(i.length/2&128)throw new e("tlv.encode: long form length too big");var o=n>127?T(i.length/2|128):"";return T(r)+o+i+t},decode:function(r,t){var e=jr.Err,n=0;if(r<0||r>256)throw new e("tlv.encode: wrong tag");if(t.length<2||t[n++]!==r)throw new e("tlv.decode: wrong tlv");var i=t[n++],o=0;if(!!(128&i)){var a=127&i;if(!a)throw new e("tlv.decode(long): indefinite length not supported");if(a>4)throw new e("tlv.decode(long): byte length is too big");var u=t.subarray(n,n+a);if(u.length!==a)throw new e("tlv.decode: length bytes not complete");if(0===u[0])throw new e("tlv.decode(long): zero leftmost byte");var f,s=(0,E.Z)(u);try{for(s.s();!(f=s.n()).done;){o=o<<8|f.value}}catch(d){s.e(d)}finally{s.f()}if(n+=a,o<128)throw new e("tlv.decode(long): not minimal encoding")}else o=i;var c=t.subarray(n,n+o);if(c.length!==o)throw new e("tlv.decode: wrong value length");return{v:c,l:t.subarray(n+o)}}},_int:{encode:function(r){var t=jr.Err;if(r<Gr)throw new t("integer: negative integers are not allowed");var e=T(r);if(8&Number.parseInt(e[0],16)&&(e="00"+e),1&e.length)throw new t("unexpected DER parsing assertion: unpadded hex");return e},decode:function(r){var t=jr.Err;if(128&r[0])throw new t("invalid signature integer: negative");if(0===r[0]&&!(128&r[1]))throw new t("invalid signature integer: unnecessary leading zero");return _r(r)}},toSig:function(r){var t=jr.Err,e=jr._int,n=jr._tlv,i="string"===typeof r?Mr(r):r;O(i);var o=n.decode(48,i),a=o.v;if(o.l.length)throw new t("invalid signature: left bytes after parsing");var u=n.decode(2,a),f=u.v,s=u.l,c=n.decode(2,s),d=c.v;if(c.l.length)throw new t("invalid signature: left bytes after parsing");return{r:e.decode(f),s:e.decode(d)}},hexFromSig:function(r){var t=jr._tlv,e=jr._int,n=t.encode(2,e.encode(r.r))+t.encode(2,e.encode(r.s));return t.encode(48,n)}},Gr=BigInt(0),Wr=BigInt(1),Yr=BigInt(2),$r=BigInt(3),Xr=BigInt(4);function Jr(r){var t=function(r){var t=Fr(r);fr(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});var e=t.endo,n=t.Fp,i=t.a;if(e){if(!n.eql(i,n.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if("object"!==typeof e||"bigint"!==typeof e.beta||"function"!==typeof e.splitScalar)throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze((0,w.Z)({},t))}(r),e=t.Fp,n=Or(t.n,t.nBitLength),a=t.toBytes||function(r,t,n){var i=t.toAffine();return W(Uint8Array.from([4]),e.toBytes(i.x),e.toBytes(i.y))},u=t.fromBytes||function(r){var t=r.subarray(1);return{x:e.fromBytes(t.subarray(0,e.BYTES)),y:e.fromBytes(t.subarray(e.BYTES,2*e.BYTES))}};function f(r){var n=t.a,i=t.b,o=e.sqr(r),a=e.mul(o,r);return e.add(e.add(a,e.mul(r,n)),i)}if(!e.eql(e.sqr(t.Gy),f(t.Gx)))throw new Error("bad generator point: equation left != right");function s(r){var e,n=t.allowedPrivateKeyLengths,i=t.nByteLength,o=t.wrapPrivateKey,a=t.n;if(n&&"bigint"!==typeof r){if(I(r)&&(r=q(r)),"string"!==typeof r||!n.includes(r.length))throw new Error("invalid private key");r=r.padStart(2*i,"0")}try{e="bigint"===typeof r?r:V(G("private key",r,i))}catch(u){throw new Error("invalid private key, expected hex or "+i+" bytes, got "+typeof r)}return o&&(e=wr(e,a)),Q("private key",e,Wr,a),e}function c(r){if(!(r instanceof h))throw new Error("ProjectivePoint expected")}var d=cr((function(r,t){var n=r.px,i=r.py,o=r.pz;if(e.eql(o,e.ONE))return{x:n,y:i};var a=r.is0();null==t&&(t=a?e.ONE:e.inv(o));var u=e.mul(n,t),f=e.mul(i,t),s=e.mul(o,t);if(a)return{x:e.ZERO,y:e.ZERO};if(!e.eql(s,e.ONE))throw new Error("invZ was invalid");return{x:u,y:f}})),l=cr((function(r){if(r.is0()){if(t.allowInfinityPoint&&!e.is0(r.py))return;throw new Error("bad point: ZERO")}var n=r.toAffine(),i=n.x,o=n.y;if(!e.isValid(i)||!e.isValid(o))throw new Error("bad point: x or y not FE");var a=e.sqr(o),u=f(i);if(!e.eql(a,u))throw new Error("bad point: equation left != right");if(!r.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0})),h=function(){function r(t,n,o){if((0,i.Z)(this,r),this.px=t,this.py=n,this.pz=o,null==t||!e.isValid(t))throw new Error("x required");if(null==n||!e.isValid(n))throw new Error("y required");if(null==o||!e.isValid(o))throw new Error("z required");Object.freeze(this)}return(0,o.Z)(r,[{key:"x",get:function(){return this.toAffine().x}},{key:"y",get:function(){return this.toAffine().y}},{key:"_setWindowSize",value:function(r){y.setWindowSize(this,r)}},{key:"assertValidity",value:function(){l(this)}},{key:"hasEvenY",value:function(){var r=this.toAffine().y;if(e.isOdd)return!e.isOdd(r);throw new Error("Field doesn't support isOdd")}},{key:"equals",value:function(r){c(r);var t=this.px,n=this.py,i=this.pz,o=r.px,a=r.py,u=r.pz,f=e.eql(e.mul(t,u),e.mul(o,i)),s=e.eql(e.mul(n,u),e.mul(a,i));return f&&s}},{key:"negate",value:function(){return new r(this.px,e.neg(this.py),this.pz)}},{key:"double",value:function(){var n=t.a,i=t.b,o=e.mul(i,$r),a=this.px,u=this.py,f=this.pz,s=e.ZERO,c=e.ZERO,d=e.ZERO,l=e.mul(a,a),h=e.mul(u,u),v=e.mul(f,f),g=e.mul(a,u);return g=e.add(g,g),d=e.mul(a,f),d=e.add(d,d),s=e.mul(n,d),c=e.mul(o,v),c=e.add(s,c),s=e.sub(h,c),c=e.add(h,c),c=e.mul(s,c),s=e.mul(g,s),d=e.mul(o,d),v=e.mul(n,v),g=e.sub(l,v),g=e.mul(n,g),g=e.add(g,d),d=e.add(l,l),l=e.add(d,l),l=e.add(l,v),l=e.mul(l,g),c=e.add(c,l),v=e.mul(u,f),v=e.add(v,v),l=e.mul(v,g),s=e.sub(s,l),d=e.mul(v,h),d=e.add(d,d),new r(s,c,d=e.add(d,d))}},{key:"add",value:function(n){c(n);var i=this.px,o=this.py,a=this.pz,u=n.px,f=n.py,s=n.pz,d=e.ZERO,l=e.ZERO,h=e.ZERO,v=t.a,g=e.mul(t.b,$r),p=e.mul(i,u),y=e.mul(o,f),w=e.mul(a,s),m=e.add(i,o),b=e.add(u,f);m=e.mul(m,b),b=e.add(p,y),m=e.sub(m,b),b=e.add(i,a);var E=e.add(u,s);return b=e.mul(b,E),E=e.add(p,w),b=e.sub(b,E),E=e.add(o,a),d=e.add(f,s),E=e.mul(E,d),d=e.add(y,w),E=e.sub(E,d),h=e.mul(v,b),d=e.mul(g,w),h=e.add(d,h),d=e.sub(y,h),h=e.add(y,h),l=e.mul(d,h),y=e.add(p,p),y=e.add(y,p),w=e.mul(v,w),b=e.mul(g,b),y=e.add(y,w),w=e.sub(p,w),w=e.mul(v,w),b=e.add(b,w),p=e.mul(y,b),l=e.add(l,p),p=e.mul(E,b),d=e.mul(m,d),d=e.sub(d,p),p=e.mul(m,y),h=e.mul(E,h),new r(d,l,h=e.add(h,p))}},{key:"subtract",value:function(r){return this.add(r.negate())}},{key:"is0",value:function(){return this.equals(r.ZERO)}},{key:"wNAF",value:function(t){return y.wNAFCached(this,t,r.normalizeZ)}},{key:"multiplyUnsafe",value:function(n){var i=t.endo,o=t.n;Q("scalar",n,Gr,o);var a=r.ZERO;if(n===Gr)return a;if(this.is0()||n===Wr)return this;if(!i||y.hasPrecomputes(this))return y.wNAFCachedUnsafe(this,n,r.normalizeZ);for(var u=i.splitScalar(n),f=u.k1neg,s=u.k1,c=u.k2neg,d=u.k2,l=a,h=a,v=this;s>Gr||d>Gr;)s&Wr&&(l=l.add(v)),d&Wr&&(h=h.add(v)),v=v.double(),s>>=Wr,d>>=Wr;return f&&(l=l.negate()),c&&(h=h.negate()),h=new r(e.mul(h.px,i.beta),h.py,h.pz),l.add(h)}},{key:"multiply",value:function(n){var i,o,a=t.endo,u=t.n;if(Q("scalar",n,Wr,u),a){var f=a.splitScalar(n),s=f.k1neg,c=f.k1,d=f.k2neg,l=f.k2,h=this.wNAF(c),v=h.p,g=h.f,p=this.wNAF(l),w=p.p,m=p.f;v=y.constTimeNegate(s,v),w=y.constTimeNegate(d,w),w=new r(e.mul(w.px,a.beta),w.py,w.pz),i=v.add(w),o=g.add(m)}else{var b=this.wNAF(n);i=b.p,o=b.f}return r.normalizeZ([i,o])[0]}},{key:"multiplyAndAddUnsafe",value:function(t,e,n){var i=r.BASE,o=function(r,t){return t!==Gr&&t!==Wr&&r.equals(i)?r.multiply(t):r.multiplyUnsafe(t)},a=o(this,e).add(o(t,n));return a.is0()?void 0:a}},{key:"toAffine",value:function(r){return d(this,r)}},{key:"isTorsionFree",value:function(){var e=t.h,n=t.isTorsionFree;if(e===Wr)return!0;if(n)return n(r,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}},{key:"clearCofactor",value:function(){var e=t.h,n=t.clearCofactor;return e===Wr?this:n?n(r,this):this.multiplyUnsafe(t.h)}},{key:"toRawBytes",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return Z("isCompressed",t),this.assertValidity(),a(r,this,t)}},{key:"toHex",value:function(){var r=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return Z("isCompressed",r),q(this.toRawBytes(r))}}],[{key:"fromAffine",value:function(t){var n=t||{},i=n.x,o=n.y;if(!t||!e.isValid(i)||!e.isValid(o))throw new Error("invalid affine point");if(t instanceof r)throw new Error("projective point not allowed");var a=function(r){return e.eql(r,e.ZERO)};return a(i)&&a(o)?r.ZERO:new r(i,o,e.ONE)}},{key:"normalizeZ",value:function(t){var n=e.invertBatch(t.map((function(r){return r.pz})));return t.map((function(r,t){return r.toAffine(n[t])})).map(r.fromAffine)}},{key:"fromHex",value:function(t){var e=r.fromAffine(u(G("pointHex",t)));return e.assertValidity(),e}},{key:"fromPrivateKey",value:function(t){return r.BASE.multiply(s(t))}},{key:"msm",value:function(t,e){return function(r,t,e,n){if(Ur(e,r),Hr(n,t),e.length!==n.length)throw new Error("arrays of points and scalars must have equal length");for(var i=r.ZERO,o=rr(BigInt(e.length)),a=o>12?o-3:o>4?o-2:o?2:1,u=(1<<a)-1,f=new Array(u+1).fill(i),s=i,c=Math.floor((t.BITS-1)/a)*a;c>=0;c-=a){f.fill(i);for(var d=0;d<n.length;d++){var l=n[d],h=Number(l>>BigInt(c)&BigInt(u));f[h]=f[h].add(e[d])}for(var v=i,g=f.length-1,p=i;g>0;g--)p=p.add(f[g]),v=v.add(p);if(s=s.add(v),0!==c)for(var y=0;y<a;y++)s=s.double()}return s}(r,n,t,e)}}]),r}();h.BASE=new h(t.Gx,t.Gy,e.ONE),h.ZERO=new h(e.ZERO,e.ONE,e.ZERO);var v,g,p=t.nBitLength,y=(v=h,g=t.endo?Math.ceil(p/2):p,{constTimeNegate:Nr,hasPrecomputes:function(r){return 1!==Dr(r)},unsafeLadder:function(r,t){for(var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v.ZERO,n=r;t>qr;)t&Tr&&(e=e.add(n)),n=n.double(),t>>=Tr;return e},precomputeWindow:function(r,t){for(var e=Cr(t,g),n=e.windows,i=e.windowSize,o=[],a=r,u=a,f=0;f<n;f++){u=a,o.push(u);for(var s=1;s<i;s++)u=u.add(a),o.push(u);a=u.double()}return o},wNAF:function(r,t,e){for(var n=Cr(r,g),i=n.windows,o=n.windowSize,a=v.ZERO,u=v.BASE,f=BigInt(Math.pow(2,r)-1),s=Math.pow(2,r),c=BigInt(r),d=0;d<i;d++){var l=d*o,h=Number(e&f);e>>=c,h>o&&(h-=s,e+=Tr);var p=l,y=l+Math.abs(h)-1,w=d%2!==0,m=h<0;0===h?u=u.add(Nr(w,t[p])):a=a.add(Nr(m,t[y]))}return{p:a,f:u}},wNAFUnsafe:function(r,t,e){for(var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:v.ZERO,i=Cr(r,g),o=i.windows,a=i.windowSize,u=BigInt(Math.pow(2,r)-1),f=Math.pow(2,r),s=BigInt(r),c=0;c<o;c++){var d=c*a;if(e===qr)break;var l=Number(e&u);if(e>>=s,l>a&&(l-=f,e+=Tr),0!==l){var h=t[d+Math.abs(l)-1];l<0&&(h=h.negate()),n=n.add(h)}}return n},getPrecomputes:function(r,t,e){var n=Pr.get(t);return n||(n=this.precomputeWindow(t,r),1!==r&&Pr.set(t,e(n))),n},wNAFCached:function(r,t,e){var n=Dr(r);return this.wNAF(n,this.getPrecomputes(n,r,e),t)},wNAFCachedUnsafe:function(r,t,e,n){var i=Dr(r);return 1===i?this.unsafeLadder(r,t,n):this.wNAFUnsafe(i,this.getPrecomputes(i,r,e),t,n)},setWindowSize:function(r,t){Lr(t,g),zr.set(r,t),Pr.delete(r)}});return{CURVE:t,ProjectivePoint:h,normPrivateKeyToScalar:s,weierstrassEquation:f,isWithinCurveOrder:function(r){return J(r,Wr,t.n)}}}function Qr(r){var t=function(r){var t=Fr(r);return fr(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze((0,w.Z)({lowS:!0},t))}(r),e=t.Fp,a=t.n,u=e.BYTES+1,f=2*e.BYTES+1;function s(r){return wr(r,a)}function c(r){return Er(r,a)}var d=Jr((0,w.Z)((0,w.Z)({},t),{},{toBytes:function(r,t,n){var i=t.toAffine(),o=e.toBytes(i.x),a=W;return Z("isCompressed",n),n?a(Uint8Array.from([t.hasEvenY()?2:3]),o):a(Uint8Array.from([4]),o,e.toBytes(i.y))},fromBytes:function(r){var t=r.length,n=r[0],i=r.subarray(1);if(t!==u||2!==n&&3!==n){if(t===f&&4===n)return{x:e.fromBytes(i.subarray(0,e.BYTES)),y:e.fromBytes(i.subarray(e.BYTES,2*e.BYTES))};throw new Error("invalid Point, expected length of "+u+", or uncompressed "+f+", got "+t)}var o=V(i);if(!J(o,Wr,e.ORDER))throw new Error("Point is not on curve");var a,s=v(o);try{a=e.sqrt(s)}catch(d){var c=d instanceof Error?": "+d.message:"";throw new Error("Point is not on curve"+c)}return 1===(1&n)!==((a&Wr)===Wr)&&(a=e.neg(a)),{x:o,y:a}}})),l=d.ProjectivePoint,h=d.normPrivateKeyToScalar,v=d.weierstrassEquation,g=d.isWithinCurveOrder,p=function(r){return q(M(r,t.nByteLength))};function y(r){return r>a>>Wr}function m(r){return y(r)?s(-r):r}var b=function(r,t,e){return V(r.slice(t,e))},E=function(){function r(t,e,n){(0,i.Z)(this,r),this.r=t,this.s=e,this.recovery=n,this.assertValidity()}return(0,o.Z)(r,[{key:"assertValidity",value:function(){Q("r",this.r,Wr,a),Q("s",this.s,Wr,a)}},{key:"addRecoveryBit",value:function(t){return new r(this.r,this.s,t)}},{key:"recoverPublicKey",value:function(r){var n=this.r,i=this.s,o=this.recovery,a=S(G("msgHash",r));if(null==o||![0,1,2,3].includes(o))throw new Error("recovery id invalid");var u=2===o||3===o?n+t.n:n;if(u>=e.ORDER)throw new Error("recovery id 2 or 3 invalid");var f=0===(1&o)?"02":"03",d=l.fromHex(f+p(u)),h=c(u),v=s(-a*h),g=s(i*h),y=l.BASE.multiplyAndAddUnsafe(d,v,g);if(!y)throw new Error("point at infinify");return y.assertValidity(),y}},{key:"hasHighS",value:function(){return y(this.s)}},{key:"normalizeS",value:function(){return this.hasHighS()?new r(this.r,s(-this.s),this.recovery):this}},{key:"toDERRawBytes",value:function(){return F(this.toDERHex())}},{key:"toDERHex",value:function(){return jr.hexFromSig({r:this.r,s:this.s})}},{key:"toCompactRawBytes",value:function(){return F(this.toCompactHex())}},{key:"toCompactHex",value:function(){return p(this.r)+p(this.s)}}],[{key:"fromCompact",value:function(e){var n=t.nByteLength;return e=G("compactSignature",e,2*n),new r(b(e,0,n),b(e,n,2*n))}},{key:"fromDER",value:function(t){var e=jr.toSig(G("DER",t));return new r(e.r,e.s)}}]),r}(),B={isValidPrivateKey:function(r){try{return h(r),!0}catch(t){return!1}},normPrivateKeyToScalar:h,randomPrivateKey:function(){var r=Rr(t.n);return function(r,t){var e=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=r.length,i=Zr(t),o=Rr(t);if(n<16||n<o||n>1024)throw new Error("expected "+o+"-1024 bytes of input, got "+n);var a=wr(e?_(r):V(r),t-lr)+lr;return e?K(a,i):M(a,i)}(t.randomBytes(r),t.n)},precompute:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.BASE;return t._setWindowSize(r),t.multiply(BigInt(3)),t}};function x(r){var t=I(r),e="string"===typeof r,n=(t||e)&&r.length;return t?n===u||n===f:e?n===2*u||n===2*f:r instanceof l}var A=t.bits2int||function(r){if(r.length>8192)throw new Error("input is too large");var e=V(r),n=8*r.length-t.nBitLength;return n>0?e>>BigInt(n):e},S=t.bits2int_modN||function(r){return s(A(r))},k=nr(t.nBitLength);function O(r){return Q("num < 2^"+t.nBitLength,r,Gr,k),M(r,t.nByteLength)}function R(r,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:T;if(["recovered","canonical"].some((function(r){return r in o})))throw new Error("sign() legacy options not supported");var a=t.hash,u=t.randomBytes,f=o.lowS,d=o.prehash,v=o.extraEntropy;null==f&&(f=!0),r=G("msgHash",r),Vr(o),d&&(r=G("prehashed msgHash",a(r)));var p=S(r),w=h(i),b=[O(w),O(p)];if(null!=v&&!1!==v){var B=!0===v?u(e.BYTES):v;b.push(G("extraEntropy",B))}var x=W.apply(n,b),k=p;function I(r){var t=A(r);if(g(t)){var e=c(t),n=l.BASE.multiply(t).toAffine(),i=s(n.x);if(i!==Gr){var o=s(e*s(k+i*w));if(o!==Gr){var a=(n.x===i?0:2)|Number(n.y&Wr),u=o;return f&&y(o)&&(u=m(o),a^=1),new E(i,u,a)}}}}return{seed:x,k2sig:I}}var T={lowS:t.lowS,prehash:!1},N={lowS:t.lowS,prehash:!1};return l.BASE._setWindowSize(8),{CURVE:t,getPublicKey:function(r){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return l.fromPrivateKey(r).toRawBytes(t)},getSharedSecret:function(r,t){var e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(x(r))throw new Error("first arg must be private key");if(!x(t))throw new Error("second arg must be public key");var n=l.fromHex(t);return n.multiply(h(r)).toRawBytes(e)},sign:function(r,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:T,i=R(r,e,n),o=i.seed,a=i.k2sig,u=t,f=ar(u.hash.outputLen,u.nByteLength,u.hmac);return f(o,a)},verify:function(r,e,n){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:N,a=r;e=G("msgHash",e),n=G("publicKey",n);var u=o.lowS,f=o.prehash,d=o.format;if(Vr(o),"strict"in o)throw new Error("options.strict was renamed to lowS");if(void 0!==d&&"compact"!==d&&"der"!==d)throw new Error("format must be compact or der");var h="string"===typeof a||I(a),v=!h&&!d&&"object"===typeof a&&null!==a&&"bigint"===typeof a.r&&"bigint"===typeof a.s;if(!h&&!v)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");var g,p=void 0;try{if(v&&(p=new E(a.r,a.s)),h){try{"compact"!==d&&(p=E.fromDER(a))}catch(Z){if(!(Z instanceof jr.Err))throw Z}p||"der"===d||(p=E.fromCompact(a))}g=l.fromHex(n)}catch(R){return!1}if(!p)return!1;if(u&&p.hasHighS())return!1;f&&(e=t.hash(e));var y=p,w=y.r,m=y.s,b=S(e),B=c(m),x=s(b*B),A=s(w*B),k=null===(i=l.BASE.multiplyAndAddUnsafe(g,x,A))||void 0===i?void 0:i.toAffine();if(!k)return!1;var O=s(k.x);return O===w},ProjectivePoint:l,Signature:E,utils:B}}function rt(r,t){if(Ar(r),!r.isValid(t.A)||!r.isValid(t.B)||!r.isValid(t.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");var e=function(r,t){for(var e=r.ORDER,n=Gr,i=e-Wr;i%Yr===Gr;i/=Yr)n+=Wr;var o=n,a=Yr<<o-Wr-Wr,u=a*Yr,f=(e-Wr)/u,s=(f-Wr)/Yr,c=u-Wr,d=a,l=r.pow(t,f),h=r.pow(t,(f+Wr)/Yr),v=function(t,e){var n=l,i=r.pow(e,c),a=r.sqr(i);a=r.mul(a,e);var u=r.mul(t,a);u=r.pow(u,s),u=r.mul(u,i),i=r.mul(u,e),a=r.mul(u,t);var f=r.mul(a,i);u=r.pow(f,d);var v=r.eql(u,r.ONE);i=r.mul(a,h),u=r.mul(f,n),a=r.cmov(i,a,v),f=r.cmov(u,f,v);for(var g=o;g>Wr;g--){var p=g-Yr;p=Yr<<p-Wr;var y=r.pow(f,p),w=r.eql(y,r.ONE);i=r.mul(a,n),n=r.mul(n,n),y=r.mul(f,n),a=r.cmov(i,a,w),f=r.cmov(y,f,w)}return{isValid:v,value:a}};if(r.ORDER%Xr===$r){var g=(r.ORDER-$r)/Xr,p=r.sqrt(r.neg(t));v=function(t,e){var n=r.sqr(e),i=r.mul(t,e);n=r.mul(n,i);var o=r.pow(n,g);o=r.mul(o,i);var a=r.mul(o,p),u=r.mul(r.sqr(o),e),f=r.eql(u,t);return{isValid:f,value:r.cmov(a,o,f)}}}return v}(r,t.Z);if(!r.isOdd)throw new Error("Fp.isOdd is not implemented!");return function(n){var i,o,a,u,f,s,c,d;i=r.sqr(n),i=r.mul(i,t.Z),o=r.sqr(i),o=r.add(o,i),a=r.add(o,r.ONE),a=r.mul(a,t.B),u=r.cmov(t.Z,r.neg(o),!r.eql(o,r.ZERO)),u=r.mul(u,t.A),o=r.sqr(a),s=r.sqr(u),f=r.mul(s,t.A),o=r.add(o,f),o=r.mul(o,a),s=r.mul(s,u),f=r.mul(s,t.B),o=r.add(o,f),c=r.mul(i,a);var l=e(o,s),h=l.isValid,v=l.value;d=r.mul(i,n),d=r.mul(d,v),c=r.cmov(c,a,h),d=r.cmov(d,v,h);var g=r.isOdd(n)===r.isOdd(d);return d=r.cmov(r.neg(d),d,g),{x:c=r.div(c,u),y:d}}}var tt=V;function et(r,t){if(it(r),it(t),r<0||r>=1<<8*t)throw new Error("invalid I2OSP input: "+r);for(var e=Array.from({length:t}).fill(0),n=t-1;n>=0;n--)e[n]=255&r,r>>>=8;return new Uint8Array(e)}function nt(r,t){for(var e=new Uint8Array(r.length),n=0;n<r.length;n++)e[n]=r[n]^t[n];return e}function it(r){if(!Number.isSafeInteger(r))throw new Error("number expected")}function ot(r,t,e){fr(e,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});var n=e.p,i=e.k,o=e.m,a=e.hash,u=e.expand,f=e.DST;O(r),it(t);var s,c="string"===typeof f?$(f):f,d=n.toString(2).length,l=Math.ceil((d+i)/8),h=t*o*l;if("xmd"===u)s=function(r,t,e,n){O(r),O(t),it(e),t.length>255&&(t=n(W($("H2C-OVERSIZE-DST-"),t)));var i=n.outputLen,o=n.blockLen,a=Math.ceil(e/i);if(e>65535||a>255)throw new Error("expand_message_xmd: invalid lenInBytes");var u=W(t,et(t.length,1)),f=et(0,o),s=et(e,2),c=new Array(a),d=n(W(f,r,s,et(0,1),u));c[0]=n(W(d,et(1,1),u));for(var l=1;l<=a;l++){var h=[nt(d,c[l-1]),et(l+1,1),u];c[l]=n(W.apply(void 0,h))}return W.apply(void 0,c).slice(0,e)}(r,c,h,a);else if("xof"===u)s=function(r,t,e,n,i){if(O(r),O(t),it(e),t.length>255){var o=Math.ceil(2*n/8);t=i.create({dkLen:o}).update($("H2C-OVERSIZE-DST-")).update(t).digest()}if(e>65535||t.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:e}).update(r).update(et(e,2)).update(t).update(et(t.length,1)).digest()}(r,c,h,i,a);else{if("_internal_pass"!==u)throw new Error('expand must be "xmd" or "xof"');s=r}for(var v=new Array(t),g=0;g<t;g++){for(var p=new Array(o),y=0;y<o;y++){var w=l*(y+g*o),m=s.subarray(w,w+l);p[y]=wr(tt(m),n)}v[g]=p}return v}var at=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),ut=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),ft=BigInt(1),st=BigInt(2),ct=function(r,t){return(r+t/st)/t};function dt(r){var t=at,e=BigInt(3),n=BigInt(6),i=BigInt(11),o=BigInt(22),a=BigInt(23),u=BigInt(44),f=BigInt(88),s=r*r*r%t,c=s*s*r%t,d=br(c,e,t)*c%t,l=br(d,e,t)*c%t,h=br(l,st,t)*s%t,v=br(h,i,t)*h%t,g=br(v,o,t)*v%t,p=br(g,u,t)*g%t,y=br(p,f,t)*p%t,w=br(y,u,t)*g%t,m=br(w,e,t)*c%t,b=br(m,a,t)*v%t,E=br(b,n,t)*s%t,B=br(E,st,t);if(!lt.eql(lt.sqr(B),r))throw new Error("Cannot find square root");return B}var lt=Or(at,void 0,void 0,{sqrt:dt}),ht=function(r,t){var e=function(t){return Qr((0,w.Z)((0,w.Z)({},r),function(r){return{hash:r,hmac:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return b(r,t,c.eV.apply(void 0,n))},randomBytes:c.O6}}(t)))};return(0,w.Z)((0,w.Z)({},e(t)),{},{create:e})}({a:BigInt(0),b:BigInt(7),Fp:lt,n:ut,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:function(r){var t=ut,e=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-ft*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=e,a=BigInt("0x100000000000000000000000000000000"),u=ct(o*r,t),f=ct(-n*r,t),s=wr(r-u*e-f*i,t),c=wr(-u*n-f*o,t),d=s>a,l=c>a;if(d&&(s=t-s),l&&(c=t-c),s>a||c>a)throw new Error("splitScalar: Endomorphism failed, k="+r);return{k1neg:d,k1:s,k2neg:l,k2:c}}}},y),vt=BigInt(0),gt={};function pt(r){var t=gt[r];if(void 0===t){var e=y(Uint8Array.from(r,(function(r){return r.charCodeAt(0)})));t=W(e,e),gt[r]=t}for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return y(W.apply(void 0,[t].concat(i)))}var yt=function(r){return r.toRawBytes(!0).slice(1)},wt=function(r){return M(r,32)},mt=function(r){return wr(r,at)},bt=function(r){return wr(r,ut)},Et=ht.ProjectivePoint;function Bt(r){var t=ht.utils.normPrivateKeyToScalar(r),e=Et.fromPrivateKey(t);return{scalar:e.hasEvenY()?t:bt(-t),bytes:yt(e)}}function xt(r){Q("x",r,ft,at);var t=mt(r*r),e=dt(mt(t*r+BigInt(7)));e%st!==vt&&(e=mt(-e));var n=new Et(r,e,ft);return n.assertValidity(),n}var At=V;function St(){for(var r=arguments.length,t=new Array(r),e=0;e<r;e++)t[e]=arguments[e];return bt(At(pt.apply(void 0,["BIP0340/challenge"].concat(t))))}function kt(r){return Bt(r).bytes}function It(r,t){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(0,c.O6)(32),n=G("message",r),i=Bt(t),o=i.bytes,a=i.scalar,u=G("auxRand",e,32),f=wt(a^At(pt("BIP0340/aux",u))),s=pt("BIP0340/nonce",f,o,n),d=bt(At(s));if(d===vt)throw new Error("sign failed: k is zero");var l=Bt(d),h=l.bytes,v=l.scalar,g=St(h,o,n),p=new Uint8Array(64);if(p.set(h,0),p.set(wt(bt(v+g*a)),32),!Ot(p,n,o))throw new Error("sign: Invalid signature produced");return p}function Ot(r,t,e){var n,i,o,a=G("signature",r,64),u=G("message",t),f=G("publicKey",e,32);try{var s=xt(At(f)),c=At(a.subarray(0,32));if(!J(c,ft,at))return!1;var d=At(a.subarray(32,64));if(!J(d,ft,ut))return!1;var l=St(wt(c),yt(s),u),h=(n=s,i=d,o=bt(-l),Et.BASE.multiplyAndAddUnsafe(n,i,o));return!(!h||!h.hasEvenY()||h.toAffine().x!==c)}catch(v){return!1}}var Zt=function(){return{getPublicKey:kt,sign:It,verify:Ot,utils:{randomPrivateKey:ht.utils.randomPrivateKey,lift_x:xt,pointToBytes:yt,numberToBytesBE:M,bytesToNumberBE:V,taggedHash:pt,mod:wr}}}(),Rt=function(){return function(r,t){var e=t.map((function(r){return Array.from(r).reverse()}));return function(t,n){var i=e.map((function(e){return e.reduce((function(e,n){return r.add(r.mul(e,t),n)}))})),o=(0,x.Z)(i,4),a=o[0],u=o[1],f=o[2],s=o[3];return t=r.div(a,u),n=r.mul(n,r.div(f,s)),{x:t,y:n}}}(lt,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map((function(r){return r.map((function(r){return BigInt(r)}))})))}(),qt=function(){return rt(lt,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:lt.create(BigInt("-11"))})}(),Tt=function(){return function(r,t,e){if("function"!==typeof t)throw new Error("mapToCurve() must be defined");return{hashToCurve:function(n,i){var o=ot(n,2,(0,w.Z)((0,w.Z)({},e),{},{DST:e.DST},i)),a=r.fromAffine(t(o[0])),u=r.fromAffine(t(o[1])),f=a.add(u).clearCofactor();return f.assertValidity(),f},encodeToCurve:function(n,i){var o=ot(n,1,(0,w.Z)((0,w.Z)({},e),{},{DST:e.encodeDST},i)),a=r.fromAffine(t(o[0])).clearCofactor();return a.assertValidity(),a},mapToCurve:function(e){if(!Array.isArray(e))throw new Error("mapToCurve: expected array of bigints");var n,i=(0,E.Z)(e);try{for(i.s();!(n=i.n()).done;)if("bigint"!==typeof n.value)throw new Error("mapToCurve: expected array of bigints")}catch(a){i.e(a)}finally{i.f()}var o=r.fromAffine(t(e)).clearCofactor();return o.assertValidity(),o}}}(ht.ProjectivePoint,(function(r){var t=qt(lt.create(r[0])),e=t.x,n=t.y;return Rt(e,n)}),{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:lt.ORDER,m:1,k:128,expand:"xmd",hash:y})}(),Nt=function(){return Tt.hashToCurve}(),Lt=function(){return Tt.encodeToCurve}()}}]);
//# sourceMappingURL=5445.a75a76b2.chunk.js.map